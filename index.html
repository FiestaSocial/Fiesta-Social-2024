<!DOCTYPE html>
<html lang="es">
<head>
    <!-- Meta y estilos -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiesta Social 2024</title>
    <style>
        /* Estilos CSS */
        /* [Incluye aquí tus estilos CSS existentes] */
    </style>
</head>
<body>
    <!-- [Tu contenido HTML existente] -->

    <script>
        // [Otras funciones JavaScript existentes]

        function submitForm() {
            const mesaInput = document.getElementById("mesa");
            const selectedMesa = mesaInput.value;

            // [Tu código de validación existente...]

            let guestForm = document.getElementById("guestForm");
            let acompanantesForm = document.getElementById("acompanantesForm");

            if (guestForm.checkValidity() && acompanantesForm.checkValidity()) {
                const formData = new FormData(guestForm);
                const acompanantesData = new FormData(acompanantesForm);

                // Agregamos los campos de acompañantes al FormData
                acompanantesData.forEach((value, key) => {
                    formData.append(key, value);
                });

                // Enviamos el FormData al Google Apps Script
                fetch('https://script.google.com/macros/s/AKfycbyuXTuFi0DP9mGfx-j0u0Jim_UzqGo9SBpU7HjkJp0LPRXt96amwUHPZmijk8H9I0A/exec', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.text())
                .then(result => {
                    console.log(result);
                    showConfirmation();
                    fetchGuestsData();
                })
                .catch(error => {
                    alert('Error: ' + error);
                });
            } else {
                alert("Por favor, complete todos los campos requeridos.");
            }
        }

        // [El resto de tu código JavaScript existente]
    </script>
</body>
</html>
